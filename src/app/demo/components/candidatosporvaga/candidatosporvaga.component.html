<p-toast></p-toast>

<div class="grid">

  <!-- COLUNA 1 — LISTA DE VAGAS -->
  <div class="col-12 lg:col-4">
    <div class="card p-3">

      <h3 class="text-900 font-bold mb-3">Minhas Vagas</h3>

      <p-listbox 
        [options]="vagas" 
        optionLabel="titulo"
        [(ngModel)]="selecionada"
        (onChange)="selecionarVaga($event.value)"
        [filter]="true"
        [style]="{ width: '100%' }"
        [emptyFilterMessage]="'Nenhuma vaga encontrada'"
        [listStyle]="{ 'max-height': '400px' }">
      </p-listbox>

    </div>
  </div>

  <!-- COLUNA 2 — LISTA DE CANDIDATOS -->
  <div class="col-12 lg:col-8">
    <div class="card p-4">

      <h3 class="text-900 font-bold mb-4">
        Candidatos para: 
        <span class="text-primary">{{ selecionada?.titulo || 'Selecione uma vaga' }}</span>
      </h3>

      <p-table 
        [value]="candidatos"
        [loading]="carregandoCandidatos"
        responsiveLayout="scroll">

        <!-- CABEÇALHO -->
        <ng-template pTemplate="header">
          <tr>
            <th>Nome</th>
            <th>Email</th>
            <th>CPF</th>
            <th>Data</th>
            <th>Status</th>
            <th>Agendado</th>
          </tr>
        </ng-template>

        <!-- LINHAS -->
        <ng-template pTemplate="body" let-c>
          <tr>
            <td>{{ c.nome_candidato }}</td>
            <td>{{ c.email }}</td>
            <td>{{ c.cpf }}</td>
            <td>{{ c.data_candidatura }}</td>
            <td>{{ c.status }}</td>

            <!-- NOVA COLUNA COM SELECT -->
            <td>
              <p-dropdown
                [options]="[
                  {label: 'SIM', value: 'SIM'},
                  {label: 'NÃO', value: 'NÃO'},
                  {label: 'A REVISAR', value: 'A REVISAR'}
                ]"
                [(ngModel)]="c.agendado"
                placeholder="Selecione"
                (onChange)="atualizarAgendado(c)"
                styleClass="w-full"
              >
              </p-dropdown>
            </td>

          </tr>
        </ng-template>

        <!-- SEM RESULTADOS -->
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="6" class="text-center">
              Nenhum candidato para esta vaga.
            </td>
          </tr>
        </ng-template>

      </p-table>

    </div>
  </div>

</div>
