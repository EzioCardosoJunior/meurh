<p-confirmDialog></p-confirmDialog>
<p-toast></p-toast>

<div class="card">
    <div class="text-900 text-xl font-semibold mb-3">Último Emprego Cadastrado</div>

    <p-table [value]="registroEmprego || []" responsiveLayout="scroll">

        <ng-template pTemplate="header">
            <tr>
                <th>Empresa</th>
                <th>Função</th>
                <th>Período</th>
                <th>Atual</th>
                <th>Atividades</th>
                <th>Salário Atual</th>
                <th style="width: 6rem;"></th>
            </tr>
        </ng-template>

        <ng-template pTemplate="body" let-item>
            <tr>
                <td>{{ item.empresa }}</td>
                <td>{{ item.funcao }}</td>

                <td>
                    {{ item.data_entrada | date:'dd/MM/yyyy' }} -
                    {{ item.atual ? 'Atual' : (item.data_termino | date:'dd/MM/yyyy') }}
                </td>

                <td>{{ item.atual ? 'Sim' : 'Não' }}</td>

                <td [innerHTML]="item.atividades"></td>

                <td>
                    {{ item.salario_atual ? ('R$ ' + (item.salario_atual | number:'1.2-2')) : '-' }}
                </td>

                <td class="text-center">
                    <button
                        pButton 
                        icon="pi pi-trash"
                        class="p-button-danger p-button-text p-button-rounded"
                        (click)="confirmDelete(item.id)">
                    </button>
                </td>
            </tr>
        </ng-template>

        <ng-template pTemplate="emptymessage">
            <tr>
                <td colspan="7" class="text-center">Nenhum registro encontrado.</td>
            </tr>
        </ng-template>

    </p-table>
</div>


<div class="card p-fluid">
    <span class="block text-900 font-bold text-xl mb-4">Último Emprego</span>

    <form [formGroup]="empregoForm" class="grid">

        <!-- COLUNA ESQUERDA -->
        <div class="col-12 lg:col-6">

            <div class="field">
                <label class="font-semibold mb-2 block">Empresa</label>
                <input pInputText type="text" formControlName="empresa" placeholder="Empresa" />
            </div>

            <div class="field">
                <label class="font-semibold mb-2 block">Data de entrada</label>
                <input pInputText type="date" formControlName="data_entrada" />
            </div>

            <div class="field">
                <label class="font-semibold mb-2 block">Data de término</label>
                <input pInputText type="date" formControlName="data_termino" />
            </div>

            <div class="field">
                <label class="font-semibold mb-2 block">Salário Atual (R$)</label>
                <input 
                    pInputText 
                    type="number" 
                    placeholder="Ex: 3500" 
                    formControlName="salario_atual" />
            </div>

        </div>

        <!-- COLUNA DIREITA -->
        <div class="col-12 lg:col-6">

            <div class="field">
                <label class="font-semibold mb-2 block">Último cargo ou função</label>
                <input pInputText type="text" placeholder="Cargo / Função" formControlName="funcao" />
            </div>

            <div class="field border-1 surface-border flex justify-content-between align-items-center p-3 border-round">
                <span class="text-900 font-bold">Emprego atual</span>
                <p-inputSwitch formControlName="atual"></p-inputSwitch>
            </div>

        </div>

        <!-- DESCRIÇÃO -->
        <div class="col-12">
            <span class="block text-900 font-bold text-xl mb-3 mt-4">
                Funções e atividades realizadas
            </span>

            <div class="field">
                <p-editor formControlName="atividades" [style]="{ height: '250px' }"></p-editor>
            </div>
        </div>

        <!-- BOTÕES -->
        <div class="col-12 flex flex-column sm:flex-row justify-content-between align-items-center gap-3 mt-3">

            <button 
                pButton
                class="p-button-danger flex-1 p-button-outlined"
                label="Limpar"
                icon="pi pi-trash"
                (click)="limpar()">
            </button>

            <button 
                pButton
                class="p-button-primary flex-1"
                label="Salvar"
                icon="pi pi-check"
                (click)="salvar()">
            </button>

            <button 
                *ngIf="empregoForm.get('id')"
                pButton
                class="p-button-danger flex-1"
                label="Excluir registro"
                icon="pi pi-trash"
                (click)="excluir()">
            </button>

        </div>

    </form>
</div>
