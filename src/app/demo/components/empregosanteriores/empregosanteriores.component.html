<p-confirmDialog></p-confirmDialog>
<p-toast></p-toast>

<div class="grid">
    <!-- TABELA -->
    <div class="col-12">
        <div class="card">
            <div class="text-900 text-xl font-semibold mb-3">Empregos Cadastrados</div>

            <p-table [value]="empregos" [paginator]="true" [rows]="8" responsiveLayout="scroll">
                <ng-template pTemplate="header">
                    <tr>
                        <th>Empresa</th>
                        <th>Entrada</th>
                        <th>Saída</th>
                        <th>Cargo</th>

                        <!-- NOVA COLUNA -->
                        <th>Salário Final</th>

                        <th style="width: 6rem;"></th>
                    </tr>
                </ng-template>

                <ng-template pTemplate="body" let-emp>
                    <tr>
                        <td>{{ emp.nome_empresa }}</td>
                        <td>{{ emp.data_entrada }}</td>
                        <td>{{ emp.data_saida }}</td>
                        <td>{{ emp.cargo_funcao }}</td>

                        <!-- MOSTRAR VALOR FORMATADO -->
                        <td>R$ {{ emp.salario_final | number:'1.2-2' }}</td>

                        <td class="text-center">
                            <button 
                                pButton 
                                icon="pi pi-trash" 
                                class="p-button-danger p-button-text p-button-rounded"
                                (click)="confirmDelete(emp.id)">
                            </button>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </div>

    <!-- FORMULÁRIO -->
    <div class="col-12">
        <div class="card p-fluid">
            <h5 class="mb-4">Empregos Anteriores</h5>

            <form [formGroup]="empregoForm">

                <div class="grid">
                    <!-- COLUNA 1 -->
                    <div class="col-12 md:col-6">

                        <div class="field">
                            <label>Nome da empresa</label>
                            <input pInputText formControlName="nome_empresa" />
                        </div>

                        <div class="field">
                            <label>Data de entrada</label>
                            <input type="date" pInputText formControlName="data_entrada" />
                        </div>

                        <div class="field">
                            <label>Data de saída</label>
                            <input type="date" pInputText formControlName="data_saida" />
                        </div>

                        <!-- NOVO CAMPO -->
                        <div class="field">
                            <label>Salário Final (R$)</label>
                            <input 
                                pInputText 
                                type="number"
                                formControlName="salario_final"
                                placeholder="Ex: 2500.00" />
                        </div>

                    </div>

                    <!-- COLUNA 2 -->
                    <div class="col-12 md:col-6">

                        <div class="field">
                            <label>Chefe/Líder - Nome</label>
                            <input pInputText formControlName="chefe_nome" />
                        </div>

                        <div class="field">
                            <label>Chefe/Líder - Contato</label>
                            <input pInputText formControlName="chefe_contato" />
                        </div>

                        <div class="field">
                            <label>Cargo ou função</label>
                            <input pInputText formControlName="cargo_funcao" />
                        </div>
                    </div>

                    <!-- DESCRIÇÃO -->
                    <div class="col-12">
                        <div class="field">
                            <label>Descrição detalhada das atividades</label>
                            <p-editor formControlName="descricao_atividades" [style]="{height: '250px'}"></p-editor>
                        </div>
                    </div>
                </div>

                <div class="flex gap-3 mt-4">
                    <button 
                        pButton 
                        class="p-button-danger p-button-outlined flex-1"
                        label="Limpar" 
                        icon="pi pi-trash"
                        type="button"
                        (click)="empregoForm.reset()">
                    </button>

                    <button 
                        pButton 
                        class="p-button-primary flex-1"
                        label="Salvar" 
                        icon="pi pi-check" 
                        type="button"
                        (click)="salvarEmprego()">
                    </button>
                </div>

            </form>
        </div>
    </div>
</div>
